<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sql SYSTEM "amdocs-query-config.dtd">
<sql type="CdwSQL">

  <!--  ea_grid_favorite -->
  
  <!-- TODO Add join for CREATE_OPER_NAME -->
  <statement code="GRID_selectFavorites"><![CDATA[
select   f.favorite_id
       , f.view_id
       , f.grid_id
       , f.favorite_name
       , f.locked_column_count
       , f.show_footer_ind
       , f.public_ind
       , f.create_date
       , f.create_oper_id
       , trim(e.emp_first_name||' '||e.employee_surname) create_oper_name
       , c.column_id
       , c.column_order
       , c.column_width
       , c.sort_order
       , c.descending_ind
       , c.column_type
       , c.data_field
       , c.expression
from     ea_grid_favorite f
         join 
         (select favorite_id
               , column_id
               , column_order
               , column_width
               , sort_order
               , descending_ind
               , 'N' column_type
               , null data_field
               , null expression
          from   ea_grid_fav_cols 
          union all
          select favorite_id
               , column_id
               , column_order
               , null column_width
               , null sort_order
               , null descending_ind
               , 'G' column_type
               , null data_field
               , null expression
          from   ea_grid_fav_grp_cols
          union all
          select favorite_id
               , null
               , null
               , null
               , null
               , null
               , null
               , data_field
               , expression
          from   ea_grid_fav_filter_cols
         ) c
           on f.favorite_id = c.favorite_id
         left outer join employee e
           on f.create_oper_id = e.employee_id
where    f.view_id = ?
and      f.grid_id = ?
and      (f.public_ind = 'Y' or f.create_oper_id = ?)
order by (case when public_ind = 'N' then 0 else 1 end)
       , favorite_name
       , f.favorite_id
       , f.grid_id
       , c.column_order
       , c.column_id
       , c.data_field
  ]]></statement>

  <!-- TODO Add join for CREATE_OPER_NAME -->  
  <statement code="GRID_selectFavorite"><![CDATA[
select   *
from     ea_grid_favorite
where    favorite_id = ?
  ]]></statement>
  
  <statement code="GRID_insertFavorite"><![CDATA[
insert into ea_grid_favorite
      (favorite_id 
     , view_id 
     , grid_id 
     , favorite_name
     , locked_column_count 
     , show_footer_ind 
     , public_ind 
     , update_date 
     , update_oper_id 
     , create_date 
     , create_oper_id)
values (?, ?, ?, ?, ?
       ,?, ?, SYSDATE, ?, SYSDATE, ?)
  ]]></statement>
  
  <statement code="GRID_updateFavorite"><![CDATA[
update ea_grid_favorite
set    view_id = ?
     , grid_id = ?
     , favorite_name = ?
     , locked_column_count = ?
     , show_footer_ind = ?
     , public_ind = ?
     , update_date = SYSDATE
     , update_oper_id = ?
where  favorite_id = ?
  ]]></statement>
  
  <statement code="GRID_lookupFavoriteId"><![CDATA[
select favorite_id
from   ea_grid_favorite
where  view_id = ?
and    grid_id = ?
and    favorite_name = ?
and    create_oper_id = ?
  ]]></statement>
  
  <statement code="GRID_selectNewFavoriteId"><![CDATA[
select ea_grid_favorite_seq.nextval 
from   dual
  ]]></statement>
  
  <statement code="GRID_deleteFavorite"><![CDATA[
delete from ea_grid_favorite
where  favorite_id = ?
and    create_oper_id = ? 
  ]]></statement>
  
  
  
  <!--  ea_grid_fav_cols -->
  <statement code="GRID_selectFavoriteColumns"><![CDATA[
select   *
from     ea_grid_fav_cols
where    favorite_id = ?
order by column_order
  ]]></statement>
  
  <statement code="GRID_insertFavoriteColumn"><![CDATA[
insert into ea_grid_fav_cols
       (favorite_id
      , column_id
      , column_order
      , column_width
      , sort_order
      , descending_ind)
values (?, ?, ?, ?, 0, 'N')
  ]]></statement>
  
  <statement code="GRID_deleteFavoriteColumns"><![CDATA[
delete from ea_grid_fav_cols 
where  favorite_id = ?
  ]]></statement>
  
  <statement code="GRID_updateFavoriteSortColumn"><![CDATA[
update ea_grid_fav_cols 
set    sort_order = ? 
     , descending_ind = ? 
where  favorite_id = ? 
and    column_id = ?
  ]]></statement>
  
  
  
  <!--  ea_grid_fav_grp_cols -->
  <statement code="GRID_selectFavoriteGroupColumns"><![CDATA[
select   *
from     ea_grid_fav_grp_cols
where    favorite_id = ?
order by column_order
  ]]></statement>
  
  <statement code="GRID_insertFavoriteGroupColumn"><![CDATA[
insert into ea_grid_fav_grp_cols
       (favorite_id
      , column_id
      , column_order)
values (?, ?, ?)
  ]]></statement>
  
  <statement code="GRID_deleteFavoriteGroupColumns"><![CDATA[
delete from ea_grid_fav_grp_cols
where  favorite_id = ?
  ]]></statement>
  
  
  
  <!--  ea_grid_fav_filter_cols -->
  <statement code="GRID_selectFavoriteFilterColumns"><![CDATA[
select * 
from   ea_grid_fav_filter_cols
where  favorite_id = ? 
  ]]></statement>
  
  <statement code="GRID_insertFavoriteFilterColumn"><![CDATA[
insert into ea_grid_fav_filter_cols
       (favorite_id
      , data_field
      , expression)
values (?, ?, ?)
  ]]></statement>
  
  <statement code="GRID_deleteFavoriteFilterColumn"><![CDATA[
delete from ea_grid_fav_filter_cols
where  favorite_id = ? 
  ]]></statement>
  
</sql>
